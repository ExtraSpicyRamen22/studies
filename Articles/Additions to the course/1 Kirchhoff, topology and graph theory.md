# Кирхгоф, топология и теория графов

Имя Густава Кирхгофа не очень часто встречается в учебниках, пособиях или лекциях. Упоминается он лишь в двух правилах: об алгебраической сумме токов и напряжений. Но вклад Кирхгофа в электротехнику куда больше.

Именно Кирхгоф сформулировал основные понятия электрической цепи: контур, ветвь и узел. Эти понятия, а также уравнения, полученные из законов Кирхгофа, называются топологическими. Топологические уравнения устанавливают связь между токами или напряжениями различных ветвей, причем их вид и число не зависят от того, какие именно элементы входят в состав ветвей.

Вообще, топология – раздел математики, который изучает свойства фигур и графов, инвариантные относительно непрерывных деформаций. То есть в электротехнике учитывается способ соединения компонентов схемы, а не физическое расположение элементов на схеме (в отличие от топологии интегральных схем). Топология помогает формировать компактные выражения и избежать лишних вычислений. Описывать топологию электрических схем удобно используя теорию графов.

Для описания топологии цепи каждый двухполюсный элемент замещается ветвью графа, узел – вершиной графа. Направления ветвей (токов) можно выбирать произвольно, но принято, что для источников тока направление совпадает с истинным, а для источников напряжения направлено против ЭДС. Узлы схемы нумеруются в произвольном порядке, общий или заземленный узел обычно считается нулевым.
Основываясь на выведенных им правилах, Кирхгоф предложил инновационный для того времени подход к анализу электрических цепей. Этот метод именуется методом Кирхгофа, методом законов Кирхгофа или методом матрицы контуров и сечений. Алгоритм метода следующий:

– Представление схемы в виде графа, выбор положительных направлений токов.
–	Выбор независимых контуров, используя деревья и хорды. 
–	Составление системы уравнений по первому и второму законам Кирхгофа.
–	Решение системы уравнений
–	Проверка правильности расчета путем составления баланса мощностей.

Назовем количество ветвей и узлов в графе В и У соответственно. Так, Кирхгоф показал, что для описания цепи необходимо и достаточно У-1 независимых узловых уравнений и В-У+1 независимых контурных уравнений.
Этот метод стал прародителем других, более известных методов: МКТ и метода узловых потенциалов. Тем не менее, он все еще активно применяется, например в SPICE-подобных симуляторах, тк позволяет описать цепь любой конфигурации без предварительных преобразований. Однако, со временем стало более привычным записывать этот метод, как и сами правила Кирхгофа, в матричном виде.

Узловая матрица или матрица инцидентности AН – это таблица коэффициентов уравнений, составленных по первому закону Кирхгофа. Строки этой матрицы соответствуют узлам, а столбцы – ветвям схемы. Элемент матрицы aij равен 1, если ветвь j соединена с узлом i и ориентирована от него, –1, если ориентирована к нему, и 0, если ветвь j не соединена с узлом i.

Для примера рассмотрим граф 1. На нем жирными линиями изображен остов графа, а остальные ветви являются ветвями связи или же хордами.
<img width="800" alt="image" src="https://github.com/user-attachments/assets/fc1f231e-2cde-434c-8173-06a7fb7eab1c" />
 
<center>**Рисунок 1.1 – Граф 1**
</center>


A_H=(■(1&0&0&0&1&0&0&0&0@-1&-1&1&0&0&0&0&0&0@0&1&0&0&0&0&1&0&-1@0&0&-1&1&-1&0&0&0&1@0&0&0&0&0&-1&-1&-1&0@0&0&0&-1&1&0&0&1&0))

Данная матрица записана для всех узлов и называется неопределенной. При расчетах один любой узел заземляют. Переходим к узловой матрице А – редуцированной путем удаления одной строки т.е. заземленного узла.
Так, первый закон Кирхгофа имеет вид:

AI=0

где 0 – нулевая матрица-столбец
I – столбец токов

(■(1&0&0&0&1&0&0&0&0@-1&-1&1&0&0&0&0&0&0@0&1&0&0&0&0&1&0&-1@0&0&-1&1&-1&0&0&0&1@0&0&0&0&0&-1&-1&-1&0))(■(I_А@I_Б@I_В@I_Г@I_Д@I_Е@I_Ж@I_И@I_К ))=(█(0@0@0@0@0@0))

Контурная матрица B – это таблица коэффициентов уравнений, составленных по второму закону Кирхгофа. Строки контурной матрицы B соответствуют контурам, а столбцы – ветвям схемы. При составлении матрицы независимые контуры обходят в направлении ветви связи (хорды), входящей в этот контур. Элемент bij матрицы В равен 1, если ветвь j входит в контур i и ее ориентация совпадает с направлением обхода контура, –1, если не совпадает и 0, если ветвь j не входит в контур i.

(■(1&-1&0&0&0&1&-1&0&0@0&1&1&1&0&0&0&0&0@0&0&0&-1&-1&-1&0&1&0@0&0&0&0&1&0&0&0&1))

Так, второй закон Кирхгофа имеет вид:

BU=0

(■(1&-1&0&0&0&1&-1&0&0@0&1&1&1&0&0&0&0&0@0&0&0&-1&-1&-1&0&1&0@0&0&0&0&1&0&0&0&1))(■(U_А@U_Б@U_В@U_Г@U_Д@U_Е@U_Ж@U_И@U_К ))=(█(0@0@0@0@0@0))

Вообще, топологические уравнения для электрических цепей удобно получать используя М-матрицы или матрицы контуров и сечений. Они строятся на основе выбранного для графа фундаментального дерева (остова). Столбцы такой матрицы соответствуют ветвям, а строки - хордам. 
Осознавая, как “добросовестно” я и мои товарищи относились к курсу дискретной математики и теории графов, в частности, напомню, что фундаментальным называется дерево, в которое входят все узлы и соответствующие ветви без образования замкнутых контуров. Остовы находятся с помощью алгоритмов Прима и Краскала, но здесь мы о них говорить не будем. Перечитайте свои лекции ахахаххаа ну да вы же их не писали.
М-матрица строится следующим образом: каждая хорда графа поочередно включается в дерево, при этом образуется замкнутый контур. Обход этого контура выполняется в направлении, заданном направлением хорды. В строке матрицы, соответствующей данной хорде, ставится +1, если направление ветви дерева совпадает с направлением обхода контура, –1, если направление ветви дерева противоположно, 0, если ветвь не входит в данный контур. 

(■(-1&0&0&1&-1@1&1&0&0&0@0&0&1&0&0@0&-1&-1&-1&0))

Так, топологические уравнения будут иметь вид:

MU_вд+U_х=0
I_вд-M^t I_х=0

Где UВ, IВ – напряжение и ток на ветвях дерева
UХ, IХ – напряжение и ток на хордах

Количество топологических уравнений равно количеству ветвей соответствующей схемы.
Такой подход к описанию систем используется не только в электротехнике. В сложных математических моделях для САПР принято моделируемую систему представлять как совокупность однородных подсистем. Все описанное выше является электрической подсистемой.

Подсистема	Тип U, I	Базовый узел	Тип C	Тип L	Тип G	Тип R	Топологические уравнения
Электрическая	Напряжение, ток	Земля	Емкость	Индуктивность	Проводимость	Сопротивление	∑▒〖I+J=0,∑▒〖U+ε=0〗〗
Механико-поступательная	Сила, скорость	НСО	масса	упругость	Вязкое трение	Поступательное сопротивление	∑▒〖(F_i ) ̅+(F_j ) ̅=0,∑▒〖(v_i ) ̅+(v_j ) ̅=0〗〗
Механико-вращательная	Момент сил, угловая скорость	НСО	Момент инерции	Вращательная индуктивность	Вязкое вращательное трение	Вращательное сопротивление	∑▒〖(M_i ) ̅+(M_j ) ̅=0,∑▒〖(ω_i ) ̅+(ω_j ) ̅=0〗〗
Гидравлическая	Расход, давление	Вакуум	Гидро-емкость	Гидро-индуктивность	Гидро-проводность	Гидро-сопротивление	…
Тепловая	Тепловой ток, температура	Абсолютный ноль	Тепловая емкость	-	Тепло-проводность	Тепло-сопротивление	…

Топологические уравнения – одна из первых ступенек в моделировании. В принципе, в методах анализа и расчета цепей и реализации моделей не сложно разобраться, при условии владения необходимым математическим аппаратом. Проектирование и моделирование сейчас применяются во всех сферах разработки и производства.
