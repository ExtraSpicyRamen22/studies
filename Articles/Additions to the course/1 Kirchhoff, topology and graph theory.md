# Кирхгоф, топология и теория графов

Имя Густава Кирхгофа не очень часто встречается в учебниках, пособиях или лекциях. Упоминается он лишь в двух правилах: об алгебраической сумме токов и напряжений. Но вклад Кирхгофа в электротехнику куда больше.

Именно Кирхгоф сформулировал основные понятия электрической цепи: контур, ветвь и узел. Эти понятия, а также уравнения, полученные из законов Кирхгофа, называются топологическими. Топологические уравнения устанавливают связь между токами или напряжениями различных ветвей, причем их вид и число не зависят от того, какие именно элементы входят в состав ветвей.

Вообще, топология – раздел математики, который изучает свойства фигур и графов, инвариантные относительно непрерывных деформаций. То есть в электротехнике учитывается способ соединения компонентов схемы, а не физическое расположение элементов на схеме (в отличие от топологии интегральных схем). Топология помогает формировать компактные выражения и избежать лишних вычислений. Описывать топологию электрических схем удобно используя теорию графов.

Для описания топологии цепи каждый двухполюсный элемент замещается ветвью графа, узел – вершиной графа. Направления ветвей (токов) можно выбирать произвольно, но принято, что для источников тока направление совпадает с истинным, а для источников напряжения направлено против ЭДС. Узлы схемы нумеруются в произвольном порядке, общий или заземленный узел обычно считается нулевым.
Основываясь на выведенных им правилах, Кирхгоф предложил инновационный для того времени подход к анализу электрических цепей. Этот метод именуется методом Кирхгофа, методом законов Кирхгофа или методом матрицы контуров и сечений. Алгоритм метода следующий:

1. Представление схемы в виде графа, выбор положительных направлений токов.
2. Выбор независимых контуров, используя деревья и хорды. 
3. Составление системы уравнений по первому и второму законам Кирхгофа.
4.	Решение системы уравнений
5.	Проверка правильности расчета путем составления баланса мощностей.

Назовем количество ветвей и узлов в графе В и У соответственно. Так, Кирхгоф показал, что для описания цепи необходимо и достаточно У-1 независимых узловых уравнений и В-У+1 независимых контурных уравнений.

Этот метод стал прародителем других, более известных методов: МКТ и метода узловых потенциалов. Тем не менее, он все еще активно применяется, например в SPICE-подобных симуляторах, тк позволяет описать цепь любой конфигурации без предварительных преобразований. Однако, со временем стало более привычным записывать этот метод, как и сами правила Кирхгофа, в матричном виде.

Узловая матрица или матрица инцидентности AН – это таблица коэффициентов уравнений, составленных по первому закону Кирхгофа. Строки этой матрицы соответствуют узлам, а столбцы – ветвям схемы. Элемент матрицы aij равен 1, если ветвь j соединена с узлом i и ориентирована от него, –1, если ориентирована к нему, и 0, если ветвь j не соединена с узлом i.

Для примера рассмотрим граф 1. На нем жирными линиями изображен остов графа, а остальные ветви являются ветвями связи или же хордами.
<p align="center" > <img width="500" alt="image" src="https://github.com/user-attachments/assets/fc1f231e-2cde-434c-8173-06a7fb7eab1c" /></p>
 
<p align="center" >Рисунок 1.1 – Граф 1</p>

<p align="center" ><img width="500" alt="image" src="https://github.com/user-attachments/assets/1f671b41-69d2-4fdd-bae0-27b444deb4f6" /></p>

Данная матрица записана для всех узлов и называется неопределенной. При расчетах один любой узел заземляют. Переходим к узловой матрице А – редуцированной путем удаления одной строки т.е. заземленного узла.
Так, первый закон Кирхгофа имеет вид:

<p align="center" >AI=0</p>

где 0 – нулевая матрица-столбец

I – столбец токов

<p align="center" ><img width="500" alt="image" src="https://github.com/user-attachments/assets/30ab4d70-576e-412a-ad8a-1f4bdaf0f0c1" /></p>

Контурная матрица B – это таблица коэффициентов уравнений, составленных по второму закону Кирхгофа. Строки контурной матрицы B соответствуют контурам, а столбцы – ветвям схемы. При составлении матрицы независимые контуры обходят в направлении ветви связи (хорды), входящей в этот контур. Элемент bij матрицы В равен 1, если ветвь j входит в контур i и ее ориентация совпадает с направлением обхода контура, –1, если не совпадает и 0, если ветвь j не входит в контур i.

<p align="center" ><img width="500" alt="image" src="https://github.com/user-attachments/assets/9d4f5ca4-600e-4f31-bec7-7b410bed37a7" /></p>

Так, второй закон Кирхгофа имеет вид:

<p align="center" >BU=0</p>

<p align="center" ><img width="600" alt="image" src="https://github.com/user-attachments/assets/d3875ad7-e53e-40b4-bbb2-64f4e7012735" />
</p>


Вообще, топологические уравнения для электрических цепей удобно получать используя М-матрицы или матрицы контуров и сечений. Они строятся на основе выбранного для графа фундаментального дерева (остова). Столбцы такой матрицы соответствуют ветвям, а строки - хордам. 

>Осознавая, как “добросовестно” я и мои товарищи относились к курсу дискретной математики и теории графов, в частности, напомню, что фундаментальным называется дерево, в которое входят все узлы и соответствующие ветви без образования замкнутых контуров. Остовы находятся с помощью алгоритмов Прима и Краскала, но здесь мы о них говорить не будем. Перечитайте свои лекции ахахаххаа ну да вы же их не писали.

М-матрица строится следующим образом: каждая хорда графа поочередно включается в дерево, при этом образуется замкнутый контур. Обход этого контура выполняется в направлении, заданном направлением хорды. В строке матрицы, соответствующей данной хорде, ставится +1, если направление ветви дерева совпадает с направлением обхода контура, –1, если направление ветви дерева противоположно, 0, если ветвь не входит в данный контур. 

<p align="center" ><img width="300" alt="image" src="https://github.com/user-attachments/assets/446cc3f7-d039-4796-a032-eb7aba5ee50c" /></p>


Так, топологические уравнения будут иметь вид:

<p align="center" ><img width="199" height="82" alt="image" src="https://github.com/user-attachments/assets/01a29b59-8180-4f67-893a-6d5972fbc698" /></p>


Где UВ, IВ – напряжение и ток на ветвях дерева

UХ, IХ – напряжение и ток на хордах

Количество топологических уравнений равно количеству ветвей соответствующей схемы.

Такой подход к описанию систем используется не только в электротехнике. В сложных математических моделях для САПР принято моделируемую систему представлять как совокупность однородных подсистем. Все описанное выше является электрической подсистемой.

<p align="center" ><img width="1258" height="447" alt="image" src="https://github.com/user-attachments/assets/633552a8-1184-4d6c-a55b-5c843a24c729" /></p>


Топологические уравнения – одна из первых ступенек в моделировании. В принципе, в методах анализа и расчета цепей и реализации моделей не сложно разобраться, при условии владения необходимым математическим аппаратом. Проектирование и моделирование сейчас применяются во всех сферах разработки и производства.

## Литература:

[Топологическое описание схем](https://studopedia.ru/3_67248_topologicheskie-matritsi.html)

[Расчет сложных электрических цепей с использованием законов Кирхгофа]( https://eti.su/articles2/raschet-slozhnyh-jelektricheskih-cepej-s-ispolzovaniem-zakonov-kirhgofa/)

[Топология электрических цепей](https://www.ups-info.ru/for_partners/library/teoreticheskie_osnove_ilektrotehniki_dlya_ibp_ups_/topologiya_ilektricheskih_tsepey/)

[математические модели сложных подсистем](https://vs87.ru/EN/d/theory/electrical/)

[Математические модели объектов проектирования на макроуровне](//intuit.ru/studies/professional_skill_improvements/21202/courses/227/lecture/5911?page=2)

[Топологические матрицы]( https://studfile.net/preview/6382910/page:8/)
